let product_map f s1 s2 = {f e1 e2 | forall (e1 IN s1) (e2 IN s2) | true}
let product = product_map (fun x y -> (x, y))
let filter_map f s =
  let f' a s =
    match f a with
      | Some b -> s union {b}
      | none   -> s
    end in
  Set`fold f' s empty